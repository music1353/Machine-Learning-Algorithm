## 推薦系統

* 亞馬遜Amazon：35%銷售額


* 京東商城：訂單貢獻率10%



#### 可用數據

---

基本屬性、購買能力、行為特徵、興趣愛好、社交網路、心理特徵



#### 協同過濾

---

- 如何確定一個用戶是不是和你有相似的品味？
- 如何將鄰居們的喜好組織成一個排序的目錄？

> 步驟

 1.  收集用戶偏好（e.g. 評分、投票）

 2.  找到相似的用戶或物品

 3.  計算推薦

     ​

> 相似度計算

計算用戶對各商品的評分

1. 歐式距離(Enclidean Distance)

   * 兩點距離


   * 距離越近，相似度越高<img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/bfa1815838113388d78c9402bba7308d734a4af2">

2. 皮爾森相關係數(Pearson Correlation Coefficient)

   * 利用斜方差(cov)除以兩個變量的標準差
   * 看是否為正負相關 [-1, 1]

   <img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/8b0d0608b5f85d24a9c572f8d1b5769289664dfb">

3. Cosine相似度(Cosine Similarity)

   * 餘弦距離

    <img src="https://wikimedia.org/api/rest_v1/media/math/render/svg/2a8c50526e2cc7aa837477be87eff1ea703f9dec">



> 鄰居的選擇

1. 固定數量的鄰居
2. 基於相似度門檻的鄰居

<img src="https://i3.read01.com/SIG=1em1p5u/3036544f6f373032.jpg">



> 基於用戶的協同過濾（User CF）

<img src="https://images2015.cnblogs.com/blog/735119/201510/735119-20151005224839924-1629929886.gif">

* 要解決的問題

  1. 已知用戶評分矩陣Matrix R（一般都是非常稀疏）

  2. 推斷矩陣中空格empty cells處的值

     ​

* 存在的問題issues

  1. 對於新用戶，很難找到鄰居用戶

  2. 對於一個物品，所有最近的鄰居都在其上沒有打分

     ​

* 基礎解決方案

  1. 相似度計算最好使用皮爾森相似度

  2. 考慮共同打分物品的數目，如乘上min(n, N)/N，n: 共同打分數, N: 指定閾值

  3. 對打分進行標準化

  4. 設置一個相似度閾值

     ​

* 基於用戶的協同過濾不流行？

  1. 稀疏問題（用戶少，物品多，做成矩陣後過於稀疏）

  2. 數百萬用戶，計算量太大

  3. 人善變

     ​


* 場景

  1.  實時新聞

  2. 突然情況

     ​

> 基於物品的協同過濾（Item CF）

<img src="https://i2.read01.com/SIG=1rnqu4i/30436d6547713031.jpg">



* 優勢

  1. 計算性能高，通常用戶數量遠大於物品數量

  2. 可預先計算保留，物品並不善變

     ​

* 例子

<img src="https://i.ytimg.com/vi/DL5-GdMg_0o/maxresdefault.jpg">



* 用戶冷啟動問題（表示該系統積累數據量過少，無法給新用戶做個性化推薦的問題）
  1. 引導用戶把自己的一些屬性表達出來
  2. 利用現有的開放數據平台
  3. 根據用戶註冊屬性
  4. 推薦排行榜單



* 物品冷啟動問題

  1. 文本分析

  2. 主題模型

  3. 標籤

  4. 推薦排行榜單

     ​

* 場景

  1. 圖書
  2. 電商
  3. 電影



#### 隱語意模型LFM（Latent factor model）

---

* 從數據出發，進行個性化推薦

* 用戶和物品之間有著隱含的聯繫

* 隱含因子讓電腦理解就好

* 將用戶和物品通過中介隱含因子聯繫起來

  ​

  <img src="https://i.ytimg.com/vi/QC5LAMvPZEE/maxresdefault.jpg">



<img src="https://i1.read01.com/SIG=8s7s46/30426851694c3030.jpg">



> 梯度下降方向

<img src="https://i2.read01.com/SIG=1qqudc2/30426851694c3034.jpg">



> 迭代求解

<img src="https://i3.read01.com/SIG=1mb8163/30426851694c3035.jpg">



> 負樣本選擇

1. 對每個用戶，要保證正負樣本的平衡（數目相似）
2. 選取那些很熱門，而用戶卻沒有行為的物品
3. 位於用戶-物品集K{(u, i)}，其中如果(u, i)是正樣本，則有r ui=1, 則負樣本r ui=0



> 參數選擇

1. 隱特徵的個數Ｆ，通常Ｆ=100
2. 學習速率alpha，別太大
3. 標準化參數lambda，別太大
4. 負樣本/正樣本比例ratio



#### 協同過濾 v.s. 隱語意

---

* 原理：協同過濾基於統計，隱語意基於建模

* 空間複雜度：隱語意模型較小

* 實時推薦難，離線計算多

  ​

#### 評估標準

---

* 準確度(Percision)：拿預測值跟真實值作均方誤差
* 召回率(Recall)：推薦的效果好不好（哪些推薦是實際有效的）
* 覆蓋率(Coverage)：推薦的集合占全部商品多少百分比 or 使用熵值（越雜熵越大）
* 多樣性(Diversity)：所有的可能性中，推薦了多少個



#### 實現難點

---

1. 計算量大
2. 模型推薦的好壞，如何評估及更新